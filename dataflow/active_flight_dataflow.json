{
	"name": "active_flight_dataflow",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "eal_ac_active_flights",
						"type": "DatasetReference"
					},
					"name": "ActiveFlights"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "sql_active_flights",
						"type": "DatasetReference"
					},
					"name": "WriteFlightToSQL"
				},
				{
					"dataset": {
						"referenceName": "sql_carrier",
						"type": "DatasetReference"
					},
					"name": "WriteCarrierToSQL"
				},
				{
					"dataset": {
						"referenceName": "sql_carrier_address",
						"type": "DatasetReference"
					},
					"name": "WriteCarrierAddressToSQL"
				},
				{
					"dataset": {
						"referenceName": "sql_crew_security_rules",
						"type": "DatasetReference"
					},
					"name": "WriteCrewMemberSecurityRulesToSQL"
				},
				{
					"dataset": {
						"referenceName": "sql_health_check_rules",
						"type": "DatasetReference"
					},
					"name": "WriteHealthCheckRulesToSQL"
				},
				{
					"dataset": {
						"referenceName": "sql_passenger_security_rules",
						"type": "DatasetReference"
					},
					"name": "WritePassengerSecurityRules"
				}
			],
			"transformations": [
				{
					"name": "ExtractFlightColumns"
				},
				{
					"name": "SelectFlightsJson"
				},
				{
					"name": "ExtractCarrierColumns"
				},
				{
					"name": "SelectFlight"
				},
				{
					"name": "ExtractCarrierAddress"
				},
				{
					"name": "ExtractCrewMemberSecurityRules"
				},
				{
					"name": "ExtractHealthCheckRuleColumns"
				},
				{
					"name": "ExtractPassengerSecurityRulesColumns"
				},
				{
					"name": "DerivedColumn1"
				}
			],
			"script": "source(output(\n\t\tFlights as (AircraftCapacity as short, AncillaryTemplateID as string, ArrivalGate as string, ArrivalTerminal as string, BatchCrewMemberMask as string, BatchPassengerMask as string, BoardingTime as string, BookedPassengersCount as short, CancelledBy as string, CancelledReason as string, Carrier as (Address as (City as string, CountryCode as string, ID as string, Location as string, PostalCode as short, StateCode as string, Street1 as string, Street2 as string), ApisCarrierCode as double, ApisContactName as string, ApisFax as string, ApisSenderID as string, ApisTelephone as string, CarrierName as string, Code as double, DefaultAdultAge as short, DefaultChildAge as short, Email as string, EmailSenderAddress as string, EmergencySeatGateStopInstructions as string, IATA as double, ICAO as string, Icon as string, IsPrintingBagTagWithoutCheckInAllowed as boolean, Logo as string, MaximumPassengerBags as short, PnlImportCloseTime as short, Prefix as short, SelecteeGateStopInstructions as string, TsaPreCheck as boolean, UnverifiedDocumentsGateStopInstructions as string, WatchlistNoFlyMatchInstructions as string, WatchlistPreventMatchInstructions as string, WatchlistSelecteeMatchInstructions as string, Website as string), CarrierCode as double, CrewFlightPostDepartureCloseOutStatus as string, CrewFlightPreDepartureCloseOutStatus as string, CrewMemberSecurityRules as (ApplicationRecipientID as string, BatchContactDetails as boolean, BatchDestinationAddressCondition as boolean, BatchSubmission as boolean, BatchTriggerHours as boolean, BatchValidation as boolean, BuildFcmFromMclOnly as boolean, CheckinBirthPlace as boolean, CheckinClearance as boolean, CheckinContactDetails as boolean, CheckinDOB as boolean, CheckinDestinationAddress as boolean, CheckinDestinationAddressCondition as boolean, CheckinGender as boolean, CheckinHomeAddress as boolean, CheckinNationality as boolean, CheckinOrigDest as boolean, CheckinResidence as boolean, CheckinStatusOnBoard as boolean, CheckinTravelDoc as boolean, CommonAccessReference as string, CountryEntity as string, CrewAdd as boolean, CrewCancel as boolean, CrewChange as boolean, FlightAdd as boolean, FlightCancel as boolean, FlightChange as boolean, FlightPostDepartureCloseout as boolean, FlightPostDepartureCloseoutOnBoard as boolean, FlightPreDepartureCloseout as boolean, FlightRouting as short, FlightType as short, HasFlightCloseoutRequirement as boolean, InteractiveComms as boolean, InterchangeRecipientID as string, OutageVettingStatus as boolean, RequireSecurityClearance as boolean, WatchlistVet as boolean)[], CustomerID as string, DepartureGate as string, DepartureTerminal as string, DestinationAirportCity as string, DestinationAirportCountryCode as string, DestinationAirportName as string, DestinationIATA as string, DestinationICAO as string, EnableBoarding as boolean, EnableCrewAPIS as boolean, EnableDCS as boolean, EnablePassengerAPIS as boolean, EnableThroughCheckIn as boolean, EstimatedArrivalTime as string, EstimatedDepartureTime as string, ExternalID as short, FlightDelays as string[], FlightNo as short, HasPassengerSecurityTransactions as boolean, HealthCheckRule as (CarrierCode as double, CreatedBy as string, CreatedTimestampUTC as string, DestinationAirport as string, DestinationCountryEntity as string, ID as string, Instructions as string, IsActive as boolean, IsClearToBoard as boolean, IsRequireProofForRemoteCheckIn as boolean, IsRequireRemarksForFailStatus as boolean, OriginAirport as string, OriginCountryEntity as string, UpdatedBy as string), ID as string, IsCancelled as boolean, IsOpenSeating as boolean, IsProgressiveFlight as boolean, MarketingCarrierCode as string, MarketingFlightNo as string, Message as string, OriginAirportCity as string, OriginAirportCountryCode as string, OriginAirportName as string, OriginIATA as string, OriginICAO as string, PassengerSecurityRules as (ApplicationRecipientID as string, BatchClearance as boolean, BatchDestinationAddress as boolean, BatchDestinationAddressCondition as boolean, BatchOrigDest as boolean, BatchPNR as boolean, BatchResidence as boolean, BatchSubmission as boolean, BatchTriggerHours as short, BatchValidation as boolean, CheckinClearance as boolean, CheckinDOB as boolean, CheckinDestinationAddress as boolean, CheckinDestinationAddressCondition as boolean, CheckinGender as boolean, CheckinNationality as boolean, CheckinOrigDest as boolean, CheckinPNR as boolean, CheckinResidence as boolean, CheckinTravelDoc as boolean, CommonAccessReference as string, CountryEntity as string, FlightAdd as boolean, FlightCancel as boolean, FlightChange as boolean, FlightPostDepartureCloseout as boolean, FlightPostDepartureCloseoutOnBoard as boolean, FlightPreDepartureCloseout as boolean, FlightRouting as short, FlightType as short, GatePass as boolean, HasFlightCloseoutRequirement as boolean, InteractiveComms as boolean, InterchangeRecipientID as string, OutageVettingStatus as boolean, PaxAdd as boolean, PaxCancel as boolean, PaxChange as boolean, PaxTransfer as boolean, PaxVerifiedID as boolean, RequireSecurityClearance as boolean, WatchlistVet as short)[], Passengers as string[], PaxBatchPreVetStatus as string, PaxFlightPostDepartureCloseOutStatus as string, PaxFlightPreDepartureCloseOutStatus as string, PnlImported as boolean, PostDepartureCloseOutCrewMemberMask as string, PostDepartureCloseOutPassengerMask as string, PreDepartureCloseOutCrewMemberMask as string, PreDepartureCloseOutPassengerMask as string, RemainingFuelLoad as boolean, ScheduledArrivalTime as string, ScheduledDepartureTime as string, ScheduledDepartureTimeUTC as timestamp, SegmentNo as boolean, Status as string, TailNo as string, TotalCargoLoad as boolean, TotalFuelLoad as boolean, Type as string, UpliftFuelLoad as boolean, UseAverageBagWeight as boolean, UseAveragePaxWeight as boolean, WeightUnitsKgs as boolean)[],\n\t\tSuccess as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tdocumentForm: 'documentPerLine') ~> ActiveFlights\nSelectFlightsJson foldDown(unroll(Flights),\n\tmapColumn(\n\t\tAIR_CRAFT_CPTY = Flights.AircraftCapacity,\n\t\tANCLRY_TMPLT_ID = Flights.AncillaryTemplateID,\n\t\tARRVL_GT = Flights.ArrivalGate,\n\t\tARRVL_TRMNL = Flights.ArrivalTerminal,\n\t\tBTCH_CREW_MBR_MASK = Flights.BatchCrewMemberMask,\n\t\tBTCH_PSNGR_MASK = Flights.BatchPassengerMask,\n\t\tBRDNG_TIME = Flights.BoardingTime,\n\t\tBKD_PSNGR_CNT = Flights.BookedPassengersCount,\n\t\tCNCLD_BY = Flights.CancelledBy,\n\t\tCNCLD_RSN = Flights.CancelledReason,\n\t\tCARR_CD = Flights.CarrierCode,\n\t\tCREW_FLT_POST_DPTR_CLS_OUT_STS = Flights.CrewFlightPostDepartureCloseOutStatus,\n\t\tCREW_FLT_PRE_DPTR_CLS_OUT_STS = Flights.CrewFlightPreDepartureCloseOutStatus,\n\t\tCUST_ID = Flights.CustomerID,\n\t\tDPTR_GT = Flights.DepartureGate,\n\t\tDPTR_TRMNL = Flights.DepartureTerminal,\n\t\tDEST_AIRPORT_CITY = Flights.DestinationAirportCity,\n\t\tDEST_AIRPORT_CNTRY_CD = Flights.DestinationAirportCountryCode,\n\t\tDEST_AIRPORT_NAME = Flights.DestinationAirportName,\n\t\tDEST_IATA = Flights.DestinationIATA,\n\t\tDEST_ICAO = Flights.DestinationICAO,\n\t\tENABL_BRDNG = Flights.EnableBoarding,\n\t\tENABL_CREW_APIS = Flights.EnableCrewAPIS,\n\t\tENABL_DCS = Flights.EnableDCS,\n\t\tENABL_PSNGR_APIS = Flights.EnablePassengerAPIS,\n\t\tENABL_THRU_CHK_IN = Flights.EnableThroughCheckIn,\n\t\tESTD_ARRVL_TIME = Flights.EstimatedArrivalTime,\n\t\tESTD_DPTR_TIME = Flights.EstimatedDepartureTime,\n\t\tEXTRNL_ID = Flights.ExternalID,\n\t\tFLT_DLAY = Flights.FlightDelays,\n\t\tFLT_NO = Flights.FlightNo,\n\t\tHAS_PSNGR_SCRTY_TRNS = Flights.HasPassengerSecurityTransactions,\n\t\tHLTH_CHK_RULES_ID = Flights.HealthCheckRule.ID,\n\t\tPSNGRS = Flights.Passengers,\n\t\tPAX_BTCH_PRE_VET_STS = Flights.PaxBatchPreVetStatus,\n\t\tFLT_ID = Flights.ID,\n\t\tIS_CNCLD = Flights.IsCancelled,\n\t\tIS_OPEN_STNG = Flights.IsOpenSeating,\n\t\tIS_PRGRSV_FLT = Flights.IsProgressiveFlight,\n\t\tMKTG_CARR_CD = Flights.MarketingCarrierCode,\n\t\tMSG = Flights.Message,\n\t\tORIG_AIRPORT_CITY = Flights.OriginAirportCity,\n\t\tORIG_AIRPORT_CNTRY_CD = Flights.OriginAirportCountryCode,\n\t\tORIG_AIRPORT_NAME = Flights.OriginAirportName,\n\t\tORIG_IATA = Flights.OriginIATA,\n\t\tORIG_ICAO = Flights.OriginICAO,\n\t\tPSNGR_APP_RCPNT_ID = Flights.PassengerSecurityRules.ApplicationRecipientID,\n\t\tPAX_FLT_POST_DPTR_CLS_OUT_STS = Flights.PaxFlightPostDepartureCloseOutStatus,\n\t\tPAX_FLT_PRE_DPTR_CLS_OUT_STS = Flights.PaxFlightPreDepartureCloseOutStatus,\n\t\tPNL_IMPRTD = Flights.PnlImported,\n\t\tPOST_DPTR_CLS_OUT_CREW_MBR_MASK = Flights.PostDepartureCloseOutCrewMemberMask,\n\t\tPOST_DPTR_CLS_OUT_PSNGR_MASK = Flights.PostDepartureCloseOutPassengerMask,\n\t\tPRE_DPTR_CLS_OUT_CREW_MBR_MASK = Flights.PreDepartureCloseOutCrewMemberMask,\n\t\tPRE_DPTR_CLS_OUT_PSNGR_MASK = Flights.PreDepartureCloseOutPassengerMask,\n\t\tREMNG_FUEL_LOAD = Flights.RemainingFuelLoad,\n\t\tSCHDD_ARRVL_TIME = Flights.ScheduledArrivalTime,\n\t\tSCHDD_DPTR_TIME = Flights.ScheduledDepartureTime,\n\t\tSCHDD_DPTR_TIME_UTC = Flights.ScheduledDepartureTimeUTC,\n\t\tSEG_NO = Flights.SegmentNo,\n\t\tSTS = Flights.Status,\n\t\tTAIL_NO = Flights.TailNo,\n\t\tTOT_CRGO_LOAD = Flights.TotalCargoLoad,\n\t\tTOT_FUEL_LOAD = Flights.TotalFuelLoad,\n\t\tTYPE = Flights.Type,\n\t\tUPLIFT_FUEL_LOAD = Flights.UpliftFuelLoad,\n\t\tUSE_AVG_BAG_WGT = Flights.UseAverageBagWeight,\n\t\tUSE_AVG_PAX_WGT = Flights.UseAveragePaxWeight,\n\t\tWGT_UNITS_KG = Flights.WeightUnitsKgs,\n\t\tCREW_APP_RCPNT_ID = Flights.CrewMemberSecurityRules.ApplicationRecipientID\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> ExtractFlightColumns\nActiveFlights select(mapColumn(\n\t\tFlights\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectFlightsJson\nSelectFlight foldDown(unroll(Flights),\n\tmapColumn(\n\t\tAPIS_CARR_CD = Flights.Carrier.ApisCarrierCode,\n\t\tAPIS_CNTCT_NAME = Flights.Carrier.ApisContactName,\n\t\tAPIS_FAX = Flights.Carrier.ApisFax,\n\t\tAPIS_SENDR_ID = Flights.Carrier.ApisSenderID,\n\t\tAPIS_TEL = Flights.Carrier.ApisTelephone,\n\t\tCARR_NAME = Flights.Carrier.CarrierName,\n\t\tCD = Flights.Carrier.Code,\n\t\tDFLT_ADLT_AGE = Flights.Carrier.DefaultAdultAge,\n\t\tDFLT_CHILD_AGE = Flights.Carrier.DefaultChildAge,\n\t\tEMAIL = Flights.Carrier.Email,\n\t\tEMAIL_SENDR_ADDR = Flights.Carrier.EmailSenderAddress,\n\t\tEMGCY_ST_GT_STOP_INSTRN = Flights.Carrier.EmergencySeatGateStopInstructions,\n\t\tIATA = Flights.Carrier.IATA,\n\t\tICAO = Flights.Carrier.ICAO,\n\t\tIS_PRT_BAG_TAG_WOUT_CHK_IN_ALWD = Flights.Carrier.IsPrintingBagTagWithoutCheckInAllowed,\n\t\tMAX_PSNGR_BAGS = Flights.Carrier.MaximumPassengerBags,\n\t\tPNL_IMPRT_CLS_TIME = Flights.Carrier.PnlImportCloseTime,\n\t\tPRFX = Flights.Carrier.Prefix,\n\t\tSELTE_DT_STOP_INSTRN = Flights.Carrier.SelecteeGateStopInstructions,\n\t\tTSA_PRE_CHK = Flights.Carrier.TsaPreCheck,\n\t\tUNVERFD_DOCS_GT_STOP_INSTRN = Flights.Carrier.UnverifiedDocumentsGateStopInstructions,\n\t\tWTCH_LST_NO_FLY_MTCH_INSTRN = Flights.Carrier.WatchlistNoFlyMatchInstructions,\n\t\tWTCH_LST_PRVNT_MTCH_INSTRN = Flights.Carrier.WatchlistPreventMatchInstructions,\n\t\tWTCH_LST_SELTE_MTCH_INSTRN = Flights.Carrier.WatchlistSelecteeMatchInstructions,\n\t\tWEB_SITE = Flights.Carrier.Website\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> ExtractCarrierColumns\nActiveFlights select(mapColumn(\n\t\tFlights\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectFlight\nSelectFlight foldDown(unroll(Flights),\n\tmapColumn(\n\t\tCITY = Flights.Carrier.Address.City,\n\t\tCNTRY_CD = Flights.Carrier.Address.CountryCode,\n\t\tID = Flights.Carrier.Address.ID,\n\t\tLCTN = Flights.Carrier.Address.Location,\n\t\tPOSTL_CD = Flights.Carrier.Address.PostalCode,\n\t\tSTAT_CD = Flights.Carrier.Address.StateCode,\n\t\tST1 = Flights.Carrier.Address.Street1,\n\t\tST2 = Flights.Carrier.Address.Street2\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> ExtractCarrierAddress\nSelectFlight foldDown(unroll(Flights.CrewMemberSecurityRules),\n\tmapColumn(\n\t\tAPP_RCPNT_ID = Flights.CrewMemberSecurityRules.ApplicationRecipientID,\n\t\tBTCH_CNTCT_DTL = Flights.CrewMemberSecurityRules.BatchContactDetails,\n\t\tBTCH_DEST_ADDR_COND = Flights.CrewMemberSecurityRules.BatchDestinationAddressCondition,\n\t\tBTCH_SUBMSN = Flights.CrewMemberSecurityRules.BatchSubmission,\n\t\tBTCH_TRIG_HR = Flights.CrewMemberSecurityRules.BatchTriggerHours,\n\t\tBTCH_VLDN = Flights.CrewMemberSecurityRules.BatchValidation,\n\t\tBLD_FCM_FROM_MCL_ONLY = Flights.CrewMemberSecurityRules.BuildFcmFromMclOnly,\n\t\tCHK_IN_BRTH_PLACE = Flights.CrewMemberSecurityRules.CheckinBirthPlace,\n\t\tCHK_IN_CLRNC = Flights.CrewMemberSecurityRules.CheckinClearance,\n\t\tCHK_IN_CNTCT_DTL = Flights.CrewMemberSecurityRules.CheckinContactDetails,\n\t\tCHK_IN_DOB = Flights.CrewMemberSecurityRules.CheckinDOB,\n\t\tCHK_IN_DEST_ADDR = Flights.CrewMemberSecurityRules.CheckinDestinationAddress,\n\t\tCHK_IN_DEST_ADDR_COND = Flights.CrewMemberSecurityRules.CheckinDestinationAddressCondition,\n\t\tCHK_IN_GNDR = Flights.CrewMemberSecurityRules.CheckinGender,\n\t\tCHK_IN_HOME_ADDR = Flights.CrewMemberSecurityRules.CheckinHomeAddress,\n\t\tNTNALTY = Flights.CrewMemberSecurityRules.CheckinNationality,\n\t\tCHK_IN_ORIG_DEST = Flights.CrewMemberSecurityRules.CheckinOrigDest,\n\t\tRSDNC = Flights.CrewMemberSecurityRules.CheckinResidence,\n\t\tCHK_IN_STS_ON_BRD = Flights.CrewMemberSecurityRules.CheckinStatusOnBoard,\n\t\tCHK_IN_TRVL_DOC = Flights.CrewMemberSecurityRules.CheckinTravelDoc,\n\t\tCMN_ACCS_REF = Flights.CrewMemberSecurityRules.CommonAccessReference,\n\t\tCNTRY_ENTY = Flights.CrewMemberSecurityRules.CountryEntity,\n\t\tCREW_ADD = Flights.CrewMemberSecurityRules.CrewAdd,\n\t\tCREW_CNCL = Flights.CrewMemberSecurityRules.CrewCancel,\n\t\tCREW_CHG = Flights.CrewMemberSecurityRules.CrewChange,\n\t\tFLT_ADD = Flights.CrewMemberSecurityRules.FlightAdd,\n\t\tFLT_CNCL = Flights.CrewMemberSecurityRules.FlightCancel,\n\t\tFLT_CHG = Flights.CrewMemberSecurityRules.FlightChange,\n\t\tFLT_POST_DPTR_CLS_OUT = Flights.CrewMemberSecurityRules.FlightPostDepartureCloseout,\n\t\tFLT_POST_DPTR_CLS_OUT_ON_BRD = Flights.CrewMemberSecurityRules.FlightPostDepartureCloseoutOnBoard,\n\t\tFLT_PRE_DPTR_CLS_OUT = Flights.CrewMemberSecurityRules.FlightPreDepartureCloseout,\n\t\tFLT_ROUTG = Flights.CrewMemberSecurityRules.FlightRouting,\n\t\tFLT_TYP = Flights.CrewMemberSecurityRules.FlightType,\n\t\tHAS_FLT_CLS_OUT_REQT = Flights.CrewMemberSecurityRules.HasFlightCloseoutRequirement,\n\t\tINTACTV_COMM = Flights.CrewMemberSecurityRules.InteractiveComms,\n\t\tINTCHG_RCPNT_ID = Flights.CrewMemberSecurityRules.InterchangeRecipientID,\n\t\tOUTAGE_VTNG_STS = Flights.CrewMemberSecurityRules.OutageVettingStatus,\n\t\tREQ_SCRTY_CLRNC = Flights.CrewMemberSecurityRules.RequireSecurityClearance,\n\t\tWTCH_LST_VET = Flights.CrewMemberSecurityRules.WatchlistVet\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> ExtractCrewMemberSecurityRules\nSelectFlight foldDown(unroll(Flights),\n\tmapColumn(\n\t\tCARR_CD = Flights.HealthCheckRule.CarrierCode,\n\t\tCRTD_BY = Flights.HealthCheckRule.CreatedBy,\n\t\tCRTD_TIME_STMP_UTC = Flights.HealthCheckRule.CreatedTimestampUTC,\n\t\tDEST_AIRPORT = Flights.HealthCheckRule.DestinationAirport,\n\t\tDEST_CNTRY_ENTY = Flights.HealthCheckRule.DestinationCountryEntity,\n\t\tID = Flights.HealthCheckRule.ID,\n\t\tINSTRN = Flights.HealthCheckRule.Instructions,\n\t\tIS_ACTV = Flights.HealthCheckRule.IsActive,\n\t\tIS_CLR_TO_BRD = Flights.HealthCheckRule.IsClearToBoard,\n\t\tIS_REQ_PRF_FOR_RMOTE_CHK_IN = Flights.HealthCheckRule.IsRequireProofForRemoteCheckIn,\n\t\tIS_REQ_RMRK_FOR_FAIL_STS = Flights.HealthCheckRule.IsRequireRemarksForFailStatus,\n\t\tORIG_AIRPORT = Flights.HealthCheckRule.OriginAirport,\n\t\tORIG_CNTRY_ENTY = Flights.HealthCheckRule.OriginCountryEntity,\n\t\tUPDTD_BY = Flights.HealthCheckRule.UpdatedBy\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> ExtractHealthCheckRuleColumns\nSelectFlight foldDown(unroll(Flights.PassengerSecurityRules),\n\tmapColumn(\n\t\tAPP_RCPNT_ID = Flights.PassengerSecurityRules.ApplicationRecipientID,\n\t\tBTCH_CLRNCE = Flights.PassengerSecurityRules.BatchClearance,\n\t\tBTCH_DEST_ADDR = Flights.PassengerSecurityRules.BatchDestinationAddress,\n\t\tBTCH_DEST_ADDR_COND = Flights.PassengerSecurityRules.BatchDestinationAddressCondition,\n\t\tBTCH_ORIG_DEST = Flights.PassengerSecurityRules.BatchOrigDest,\n\t\tBTCH_PNR = Flights.PassengerSecurityRules.BatchPNR,\n\t\tBTCH_RSDNC = Flights.PassengerSecurityRules.BatchResidence,\n\t\tBTCH_SUBMSN = Flights.PassengerSecurityRules.BatchSubmission,\n\t\tBTCH_TRIG_HR = Flights.PassengerSecurityRules.BatchTriggerHours,\n\t\tBTCH_VLDN = Flights.PassengerSecurityRules.BatchValidation,\n\t\tCHK_IN_CLRNC = Flights.PassengerSecurityRules.CheckinClearance,\n\t\tCHK_IN_DOB = Flights.PassengerSecurityRules.CheckinDOB,\n\t\tCHK_IN_DEST_ADDR = Flights.PassengerSecurityRules.CheckinDestinationAddress,\n\t\tCHK_IN_DEST_ADDR_COND = Flights.PassengerSecurityRules.CheckinDestinationAddressCondition,\n\t\tCHK_IN_GNDR = Flights.PassengerSecurityRules.CheckinGender,\n\t\tCHK_IN_NTNALTY = Flights.PassengerSecurityRules.CheckinNationality,\n\t\tCHK_IN_ORIG_DEST = Flights.PassengerSecurityRules.CheckinOrigDest,\n\t\tCHK_IN_PNR = Flights.PassengerSecurityRules.CheckinPNR,\n\t\tCHK_IN_RSDNC = Flights.PassengerSecurityRules.CheckinResidence,\n\t\tCHK_IN_TRVL_DOC = Flights.PassengerSecurityRules.CheckinTravelDoc,\n\t\tCMN_ACCS_REF = Flights.PassengerSecurityRules.CommonAccessReference,\n\t\tCNTRY_ENTY = Flights.PassengerSecurityRules.CountryEntity,\n\t\tFLT_ADD = Flights.PassengerSecurityRules.FlightAdd,\n\t\tFLT_CNCL = Flights.PassengerSecurityRules.FlightCancel,\n\t\tFLT_CHG = Flights.PassengerSecurityRules.FlightChange,\n\t\tFLT_POST_DPTR_CLS_OUT = Flights.PassengerSecurityRules.FlightPostDepartureCloseout,\n\t\tFLT_POST_DPTR_CLS_OUT_ON_BRD = Flights.PassengerSecurityRules.FlightPostDepartureCloseoutOnBoard,\n\t\tFLT_PRE_DPTR_CLS_OUT = Flights.PassengerSecurityRules.FlightPreDepartureCloseout,\n\t\tFLT_ROUTG = Flights.PassengerSecurityRules.FlightRouting,\n\t\tFLT_TYP = Flights.PassengerSecurityRules.FlightType,\n\t\tGATE_PASS = Flights.PassengerSecurityRules.GatePass,\n\t\tHAS_FLT_CLS_OUT_REQT = Flights.PassengerSecurityRules.HasFlightCloseoutRequirement,\n\t\tINTACTV_COMM = Flights.PassengerSecurityRules.InteractiveComms,\n\t\tINTCHG_RCPNT_ID = Flights.PassengerSecurityRules.InterchangeRecipientID,\n\t\tOUTAGE_VTNG_STS = Flights.PassengerSecurityRules.OutageVettingStatus,\n\t\tPAX_ADD = Flights.PassengerSecurityRules.PaxAdd,\n\t\tPAX_CNCL = Flights.PassengerSecurityRules.PaxCancel,\n\t\tPAX_CHG = Flights.PassengerSecurityRules.PaxChange,\n\t\tPAX_XFER = Flights.PassengerSecurityRules.PaxTransfer,\n\t\tPAX_VERFD_ID = Flights.PassengerSecurityRules.PaxVerifiedID,\n\t\tREQ_SCRTY_CLRNC = Flights.PassengerSecurityRules.RequireSecurityClearance,\n\t\tWTCH_LST_VET = Flights.PassengerSecurityRules.WatchlistVet\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> ExtractPassengerSecurityRulesColumns\nExtractPassengerSecurityRulesColumns derive(ETL_CAPT_DT = currentDate('UTC'),\n\t\tADF_RUN_ID = ERROR_FUNCTION('')) ~> DerivedColumn1\nExtractFlightColumns sink(input(\n\t\tAircraftCapacity as short,\n\t\tAncillaryTemplateID as string,\n\t\tArrivalGate as string,\n\t\tArrivalTerminal as string,\n\t\tBatchCrewMemberMask as string,\n\t\tBatchPassengerMask as string,\n\t\tBoardingTime as string,\n\t\tBookedPassengersCount as short,\n\t\tCancelledBy as string,\n\t\tCancelledReason as string,\n\t\tCarrierCode as double,\n\t\tCrewFlightPostDepartureCloseOutStatus as string,\n\t\tCrewFlightPreDepartureCloseOutStatus as string,\n\t\tCustomerID as string,\n\t\tDepartureGate as string,\n\t\tDepartureTerminal as string,\n\t\tDestinationAirportCity as string,\n\t\tDestinationAirportCountryCode as string,\n\t\tDestinationAirportName as string,\n\t\tDestinationIATA as string,\n\t\tDestinationICAO as string,\n\t\tEnableBoarding as boolean,\n\t\tEnableCrewAPIS as boolean,\n\t\tEnableDCS as boolean,\n\t\tEnablePassengerAPIS as boolean,\n\t\tEnableThroughCheckIn as boolean,\n\t\tEstimatedArrivalTime as string,\n\t\tEstimatedDepartureTime as string,\n\t\tExternalID as short,\n\t\tFlightDelays as string,\n\t\tFlightNo as short,\n\t\tHasPassengerSecurityTransactions as boolean,\n\t\tHealthCheckRulesID as string,\n\t\tPassengers as string,\n\t\tPaxBatchPreVetStatus as string,\n\t\tFlightID as string,\n\t\tIsCancelled as boolean,\n\t\tIsOpenSeating as boolean,\n\t\tIsProgressiveFlight as boolean,\n\t\tMarketingCarrierCode as string,\n\t\tMessage as string,\n\t\tOriginAirportCity as string,\n\t\tOriginAirportCountryCode as string,\n\t\tOriginAirportName as string,\n\t\tOriginIATA as string,\n\t\tOriginICAO as string,\n\t\tApplicationRecipientID as string,\n\t\tPaxFlightPostDepartureCloseOutStatus as string,\n\t\tPaxFlightPreDepartureCloseOutStatus as string,\n\t\tPnlImported as boolean,\n\t\tPostDepartureCloseOutCrewMemberMask as string,\n\t\tPostDepartureCloseOutPassengerMask as string,\n\t\tPreDepartureCloseOutCrewMemberMask as string,\n\t\tPreDepartureCloseOutPassengerMask as string,\n\t\tRemainingFuelLoad as boolean,\n\t\tScheduledArrivalTime as string,\n\t\tScheduledDepartureTime as string,\n\t\tScheduledDepartureTimeUTC as timestamp,\n\t\tSegmentNo as boolean,\n\t\tStatus as string,\n\t\tTailNo as string,\n\t\tTotalCargoLoad as boolean,\n\t\tTotalFuelLoad as boolean,\n\t\tType as string,\n\t\tUpliftFuelLoad as boolean,\n\t\tUseAverageBagWeight as boolean,\n\t\tUseAveragePaxWeight as boolean,\n\t\tWeightUnitsKgs as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> WriteFlightToSQL\nExtractCarrierColumns sink(input(\n\t\tApisCarrierCode as double,\n\t\tApisContactName as string,\n\t\tApisFax as string,\n\t\tApisSenderID as string,\n\t\tApisTelephone as string,\n\t\tCarrierName as string,\n\t\tCode as double,\n\t\tDefaultAdultAge as short,\n\t\tDefaultChildAge as short,\n\t\tEmail as string,\n\t\tEmailSenderAddress as string,\n\t\tEmergencySeatGateStopInstructions as string,\n\t\tIATA as double,\n\t\tICAO as string,\n\t\tIcon as string,\n\t\tIsPrintingBagTagWithoutCheckInAllowed as boolean,\n\t\tLogo as string,\n\t\tMaximumPassengerBags as short,\n\t\tPnlImportCloseTime as short,\n\t\tPrefix as short,\n\t\tSelecteeGateStopInstructions as string,\n\t\tTsaPreCheck as boolean,\n\t\tUnverifiedDocumentsGateStopInstructions as string,\n\t\tWatchlistNoFlyMatchInstructions as string,\n\t\tWatchlistPreventMatchInstructions as string,\n\t\tWatchlistSelecteeMatchInstructions as string,\n\t\tWebsite as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> WriteCarrierToSQL\nExtractCarrierAddress sink(input(\n\t\tID as integer,\n\t\tCountryCode as string,\n\t\tCity as string,\n\t\tLocation as string,\n\t\tPostalCode as string,\n\t\tStateCode as string,\n\t\tStreet1 as string,\n\t\tStreet2 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> WriteCarrierAddressToSQL\nExtractCrewMemberSecurityRules sink(input(\n\t\tApplicationRecipientID as string,\n\t\tBatchContactDetails as boolean,\n\t\tBatchDestinationAddressCondition as boolean,\n\t\tBatchSubmission as boolean,\n\t\tBatchTriggerHours as boolean,\n\t\tBatchValidation as boolean,\n\t\tBuildFcmFromMclOnly as boolean,\n\t\tCheckinBirthPlace as boolean,\n\t\tCheckinClearance as boolean,\n\t\tCheckinContactDetails as boolean,\n\t\tCheckinDOB as boolean,\n\t\tCheckinDestinationAddress as boolean,\n\t\tCheckinDestinationAddressCondition as boolean,\n\t\tCheckinGender as boolean,\n\t\tCheckinHomeAddress as boolean,\n\t\tNationality as boolean,\n\t\tCheckinOrigDest as boolean,\n\t\tResidence as boolean,\n\t\tCheckinStatusOnBoard as boolean,\n\t\tCheckinTravelDoc as boolean,\n\t\tCommonAccessReference as string,\n\t\tCountryEntity as string,\n\t\tCrewAdd as boolean,\n\t\tCrewCancel as boolean,\n\t\tCrewChange as boolean,\n\t\tFlightAdd as boolean,\n\t\tFlightCancel as boolean,\n\t\tFlightChange as boolean,\n\t\tFlightPostDepartureCloseout as boolean,\n\t\tFlightPostDepartureCloseoutOnBoard as boolean,\n\t\tFlightPreDepartureCloseout as boolean,\n\t\tFlightRouting as integer,\n\t\tFlightType as integer,\n\t\tHasFlightCloseoutRequirement as boolean,\n\t\tInteractiveComms as boolean,\n\t\tInterchangeRecipientID as string,\n\t\tOutageVettingStatus as boolean,\n\t\tRequireSecurityClearance as boolean,\n\t\tWatchlistVet as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> WriteCrewMemberSecurityRulesToSQL\nExtractHealthCheckRuleColumns sink(input(\n\t\tCarrierCode as double,\n\t\tCreatedBy as string,\n\t\tCreatedTimestampUTC as string,\n\t\tDestinationAirport as string,\n\t\tDestinationCountryEntity as string,\n\t\tID as string,\n\t\tInstructions as string,\n\t\tIsActive as boolean,\n\t\tIsClearToBoard as boolean,\n\t\tIsRequireProofForRemoteCheckIn as boolean,\n\t\tIsRequireRemarksForFailStatus as boolean,\n\t\tOriginAirport as string,\n\t\tOriginCountryEntity as string,\n\t\tUpdatedBy as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> WriteHealthCheckRulesToSQL\nDerivedColumn1 sink(input(\n\t\tApplicationRecipientID as string,\n\t\tBatchClearance as boolean,\n\t\tBatchDestinationAddress as boolean,\n\t\tBatchDestinationAddressCondition as boolean,\n\t\tBatchOrigDest as boolean,\n\t\tBatchPNR as boolean,\n\t\tBatchResidence as boolean,\n\t\tBatchSubmission as boolean,\n\t\tBatchTriggerHours as integer,\n\t\tBatchValidation as boolean,\n\t\tCheckinClearance as boolean,\n\t\tCheckinDOB as boolean,\n\t\tCheckinDestinationAddress as boolean,\n\t\tCheckinDestinationAddressCondition as boolean,\n\t\tCheckinGender as boolean,\n\t\tCheckinNationality as boolean,\n\t\tCheckinOrigDest as boolean,\n\t\tCheckinPNR as boolean,\n\t\tCheckinResidence as boolean,\n\t\tCheckinTravelDoc as boolean,\n\t\tCommonAccessReference as string,\n\t\tCountryEntity as string,\n\t\tFlightAdd as boolean,\n\t\tFlightCancel as boolean,\n\t\tFlightChange as boolean,\n\t\tFlightPostDepartureCloseout as boolean,\n\t\tFlightPostDepartureCloseoutOnBoard as boolean,\n\t\tFlightPreDepartureCloseout as boolean,\n\t\tFlightRouting as integer,\n\t\tFlightType as integer,\n\t\tGatePass as boolean,\n\t\tHasFlightCloseoutRequirement as boolean,\n\t\tInteractiveComms as boolean,\n\t\tInterchangeRecipientID as string,\n\t\tOutageVettingStatus as boolean,\n\t\tPaxAdd as boolean,\n\t\tPaxCancel as boolean,\n\t\tPaxChange as boolean,\n\t\tPaxTransfer as boolean,\n\t\tPaxVerifiedID as boolean,\n\t\tRequireSecurityClearance as boolean,\n\t\tWatchlistVet as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> WritePassengerSecurityRules"
		}
	}
}